--------------------------------------------------------------------------------
---------------------------------- DokusCore -----------------------------------
--------------------------------------------------------------------------------
----------------------- I feel a disturbance in the force ----------------------
--------------------------------------------------------------------------------
RegisterNetEvent('DokusCore:Quests:Start', function(Data)
  local Plugin, Type = Data.Plugin, Data.Type
  local Objective, Item = Data.Objective, Data.Item

  if (Low(Type) == 'gather') then
    if (Low(Objective) == 'resources') then


      if (Item == nil) then
        local Quests = {}
        -- First get all quest items
        for k,v in pairs(_Quests.Gathering.Resources.Items) do
          if (ArrayContains(v.Plugins, Low(Plugin))) then Tabi(Quests, v.Item) end
        end

        -- Take a random item for the quest.
        local rItem = Quests[ math.random(#Quests) ]

        -- Gather all data from this item.
        local Min, Max, Variable = nil, nil, false
        local Direct, PayDef, PayMin, PayMax = nil, nil, nil, nil
        for k,v in pairs(_Quests.Gathering.Resources.Amount) do
          if (Low(v.Item) == Low(rItem)) then
            Min, Max = v.Min, v.Max
          end
        end

        for k,v in pairs(_Quests.Gathering.Resources.Payment) do
          if (Low(v.Item) == Low(rItem)) then
            Direct, PayDef = v.Direct, v.Amount.Def
            PayMin, PayMax = v.Amount.Min, v.Amount.Max
            Variable       = v.Amount.Variable
          end
        end

        local Index = {
          Plugin = Plugin, Type = Type, Objective = Objective,
          Item = rItem, Min = Min, Max = Max, Direct = Direct,
          Variable = Variable, PayDef = PayDef, PayMin = PayMin,
          PayMax = PayMax
        }

        TriggerEvent('DokusCore:Quests:Accept', Index)
      end
    end
  end
end)
--------------------------------------------------------------------------------
--------------------------------------------------------------------------------
RegisterNetEvent('DokusCore:Quests:Accept', function(Data)
  local Resource = nil
  local Sync = TCTCC('DokusCore:Sync:Get:UserData')
  if (Low(Data.Plugin) == 'lumberjack') then Resource = 'LumberJack' end

  if (Resource ~= nil) then
    local rAmount = math.random(Data.Min, Data.Max)
    local Encode = Encoded({ Item = Data.Item, Amount = rAmount })
    local Index = { Sync.SteamID, Sync.CharID, 5000, Encode }
    TriggerServerEvent('DokusCore:Core:DBIns:Events', { 'Quest', 'LumberJack', Index })
    TriggerEvent('DokusCore:'..Resource..':Quest:Gather:Resources:Started', Data, Encode)
  end
end)
--------------------------------------------------------------------------------
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
--------------------------------------------------------------------------------

































--------------------------------------------------------------------------------
--------------------------------------------------------------------------------
